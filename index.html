<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°„í¸ ê·¼ë¬´í‘œ ê´€ë¦¬</title>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body { font-family: 'Suit', sans-serif; background-color: #f5f7fa; margin: 0; padding: 20px; display: flex; justify-content: center; }
        .app-container { max-width: 800px; width: 100%; }

        /* ë©”ì¸ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .scheduler-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        /* í—¤ë” */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        .header h1 { margin: 0; font-size: 24px; color: #2c3e50; }
        .date-label { color: #7f8c8d; font-size: 14px; }

        /* ì…ë ¥ í¼ */
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; }
        .input-group input { padding: 10px; border: 1px solid #ddd; border-radius: 5px; flex-grow: 1; }
        .btn-add { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-add:hover { background: #2980b9; }

        /* ê·¼ë¬´í‘œ í…Œì´ë¸” */
        .table-container { width: 100%; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; text-align: center; font-size: 14px; }
        th { background-color: #ecf0f1; color: #2c3e50; padding: 12px; font-weight: 600; border: 1px solid #e0e0e0; }
        td { border: 1px solid #e0e0e0; padding: 0; height: 50px; vertical-align: middle; }
        
        /* ê·¼ë¬´ì ì´ë¦„ ì¹¸ */
        .worker-name { font-weight: bold; background: #fff; color: #333; padding: 10px; }
        .delete-btn { font-size: 10px; color: red; cursor: pointer; margin-left: 5px; border: 1px solid #eee; padding: 2px 5px; border-radius: 4px; }

        /* ê·¼ë¬´ ì…€ (í´ë¦­ ê°€ëŠ¥) */
        .shift-cell { cursor: pointer; height: 100%; display: flex; align-items: center; justify-content: center; font-weight: bold; transition: 0.2s; }
        .shift-cell:hover { opacity: 0.8; }

        /* ê·¼ë¬´ íƒ€ì…ë³„ ìƒ‰ìƒ */
        .type-day { background-color: #e3f2fd; color: #1976d2; } /* ì£¼ê°„ */
        .type-night { background-color: #e8eaf6; color: #3f51b5; } /* ì•¼ê°„ */
        .type-off { background-color: #ffebee; color: #c62828; } /* íœ´ë¬´ */
        .type-none { background-color: #fff; color: #ddd; } /* ë¯¸ì • */

        /* PDF ë²„íŠ¼ */
        .pdf-btn { width: 100%; padding: 15px; background: #27ae60; color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .pdf-btn:hover { background: #219150; }

        /* ì•ˆë‚´ ë¬¸êµ¬ */
        .guide { font-size: 12px; color: #999; text-align: right; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef } = React;
        const { jsPDF } = window.jspdf;

        function App() {
            const contentRef = useRef(null);
            const [workers, setWorkers] = useState([
                { id: 1, name: "ê¹€ì² ìˆ˜", shifts: ["D", "D", "N", "N", "O", "O", "D"] },
                { id: 2, name: "ì´ì˜í¬", shifts: ["O", "D", "D", "D", "D", "O", "O"] }
            ]);
            const [newName, setNewName] = useState("");

            const days = ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"];
            
            // ê·¼ë¬´ íƒ€ì… ìˆœí™˜: ì£¼ê°„(D) -> ì•¼ê°„(N) -> íœ´ë¬´(O) -> ì—†ìŒ(ë¹ˆì¹¸)
            const shiftTypes = {
                'D': { label: 'ì£¼ê°„', class: 'type-day' },
                'N': { label: 'ì•¼ê°„', class: 'type-night' },
                'O': { label: 'íœ´ë¬´', class: 'type-off' },
                '':  { label: '-', class: 'type-none' }
            };

            // ê·¼ë¬´ì ì¶”ê°€
            const addWorker = () => {
                if (!newName) return;
                const newId = workers.length > 0 ? Math.max(...workers.map(w => w.id)) + 1 : 1;
                setWorkers([...workers, { id: newId, name: newName, shifts: Array(7).fill("") }]);
                setNewName("");
            };

            // ê·¼ë¬´ì ì‚­ì œ
            const removeWorker = (id) => {
                setWorkers(workers.filter(w => w.id !== id));
            };

            // ê·¼ë¬´ ë³€ê²½ (í´ë¦­ ì‹œ ìˆœí™˜)
            const toggleShift = (workerId, dayIndex) => {
                const typeOrder = ["", "D", "N", "O"];
                
                setWorkers(workers.map(worker => {
                    if (worker.id === workerId) {
                        const currentShift = worker.shifts[dayIndex];
                        const nextIndex = (typeOrder.indexOf(currentShift) + 1) % typeOrder.length;
                        const newShifts = [...worker.shifts];
                        newShifts[dayIndex] = typeOrder[nextIndex];
                        return { ...worker, shifts: newShifts };
                    }
                    return worker;
                }));
            };

            // PDF ì €ì¥
            const handleDownloadPdf = async () => {
                const element = contentRef.current;
                if (!element) return;

                const canvas = await html2canvas(element, { scale: 2 });
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('l', 'mm', 'a4'); // ê°€ë¡œ(Landscape) ëª¨ë“œ
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save('work_schedule.pdf');
            };

            return (
                <div className="app-container">
                    <div className="input-group">
                        <input 
                            type="text" 
                            placeholder="ê·¼ë¬´ì ì´ë¦„ ì…ë ¥ (ì˜ˆ: ë°•ë¯¼ìˆ˜)" 
                            value={newName}
                            onChange={(e) => setNewName(e.target.value)}
                            onKeyPress={(e) => e.key === 'Enter' && addWorker()}
                        />
                        <button className="btn-add" onClick={addWorker}>ì¶”ê°€</button>
                    </div>

                    {/* PDFë¡œ ì €ì¥ë  ì˜ì—­ */}
                    <div className="scheduler-card" ref={contentRef}>
                        <div className="header">
                            <h1>ğŸ“… ì£¼ê°„ ê·¼ë¬´í‘œ</h1>
                            <span className="date-label">2025ë…„ 11ì›” 4ì£¼ì°¨</span>
                        </div>

                        <div className="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th style={{width: '100px'}}>ì´ë¦„</th>
                                        {days.map(day => <th key={day}>{day}</th>)}
                                    </tr>
                                </thead>
                                <tbody>
                                    {workers.map(worker => (
                                        <tr key={worker.id}>
                                            <td className="worker-name">
                                                {worker.name}
                                                <span className="delete-btn" onClick={() => removeWorker(worker.id)}>x</span>
                                            </td>
                                            {worker.shifts.map((shift, idx) => (
                                                <td key={idx} onClick={() => toggleShift(worker.id, idx)}>
                                                    <div className={`shift-cell ${shiftTypes[shift]?.class || 'type-none'}`}>
                                                        {shiftTypes[shift]?.label}
                                                    </div>
                                                </td>
                                            ))}
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                        <p className="guide">* ì¹¸ì„ í´ë¦­í•˜ë©´ [ ì£¼ê°„ â†’ ì•¼ê°„ â†’ íœ´ë¬´ ] ìˆœìœ¼ë¡œ ë³€ê²½ë©ë‹ˆë‹¤.</p>
                    </div>

                    <button className="pdf-btn" onClick={handleDownloadPdf}>
                        ğŸ“„ ê·¼ë¬´í‘œ PDFë¡œ ì €ì¥í•˜ê¸°
                    </button>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
